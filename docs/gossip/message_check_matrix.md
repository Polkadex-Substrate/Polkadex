| Message                                    | Message Type       | Incoming                                                                                      | Rebroadcast                                                                             | Outgoing |
|--------------------------------------------|--------------------|-----------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------| -------- |
| `WantWorkerNonce(from, to)`                | Request, Broadcast | `ProcessAndKeep` if `msg.worker_nonce` >  `last_snapshot.worker_nonce` in chain               | <- Same                                                                                 | <- Same  |
| `WorkerNonces(Box<Vec<ObMessage>>)`        | Response, Directed | TRUE                                                                                          | TRUE                                                                                    | TRUE     |
| `ObMessage(Box<ObMessage>)`                | Broadcast          | `ProcessAndKeep` if message has worker nonce greater than last_snapshot.worker_nonce          | `true` if `last_snapshot.worker_nonce` < `msg.worker_nonce`                             | <- Same  |
| `Want(snapshot_id, bitmap) `               | Request, Broadcast | `ProcessAndKeep` Only if fullnode and `msg.snapshot_id` EQUALS `lastest_snapshot_id` in chain | `true` for x secs, then expire OR `msg.snapshot_id` EQUALS `lastest_snapshot_id` in chain | TRUE     |
| `Have(snapshot_id, bitmap)`                | Request, Directed  | TRUE                                                                                          | TRUE                                                                                    | TRUE     |
| `RequestChunk(snapshot_id, bitmap)`        | Request, Directed  | TRUE                                                                                          | TRUE                                                                                    | TRUE     |
| `Chunk(snapshot_id, idx_of_chunk, bitmap)` | Response, Directed | TRUE                                                                                          | TRUE                                                                                    | TRUE     |
